{"version":3,"sources":["../../src/pages/modal/modal.module.ts","../../src/pages/modal/modal.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACZ;AAUpC;IAAA;IAA8B,CAAC;IAAlB,eAAe;QAR3B,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,yDAAS;aACV;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,yDAAS,CAAC;aACpC;SACF,CAAC;OACW,eAAe,CAAG;IAAD,sBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZwB;AACsC;AAC9B;AACnB;AAE6B;AACf;AACV;AAG7C;;;;;GAKG;AAOH;IAiBE,mBAAoB,IAAS,EAAS,eAAgC,EAAU,UAAsB,EAAQ,GAAa,EAAU,GAAiB,EAAS,OAAsB,EAAS,SAAoB,EAAU,IAAoB;QAA5N,SAAI,GAAJ,IAAI,CAAK;QAAS,oBAAe,GAAf,eAAe,CAAiB;QAAU,eAAU,GAAV,UAAU,CAAY;QAAQ,QAAG,GAAH,GAAG,CAAU;QAAU,QAAG,GAAH,GAAG,CAAc;QAAS,YAAO,GAAP,OAAO,CAAe;QAAS,cAAS,GAAT,SAAS,CAAW;QAAU,SAAI,GAAJ,IAAI,CAAgB;QAhBhP,SAAI,GAAO,EAAE,CAAC;QAiBZ,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QAC3B,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACxB,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QAC7B,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QAC7B,IAAI,CAAC,IAAI,CAAC,mBAAmB,GAAG,EAAE,CAAC;QACnC,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;QAC9B,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QAE1B,IAAI,CAAC,IAAI,CAAC,UAAU,GAAC,EAAE,CAAC;QACxB,IAAI,CAAC,IAAI,CAAC,aAAa,GAAC,EAAE,CAAC;QAAA,CAAC;QAC5B,IAAI,CAAC,IAAI,CAAC,IAAI,GAAC,EAAE,CAAC;QAAA,CAAC;QACnB,IAAI,CAAC,IAAI,CAAC,YAAY,GAAC,EAAE,CAAC;QAAA,CAAC;QAC3B,IAAI,CAAC,IAAI,CAAC,wBAAwB,GAAC,EAAE,CAAC;IAExC,CAAC;IAGK,oCAAgB,GAAtB;;;;;;4BACgB,qBAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;4BAC9C,KAAK,EAAE,eAAe;4BACtB,OAAO,EAAE,kDAAkD;4BAC3D,OAAO,EAAE;gCACP;oCACE,IAAI,EAAE,IAAI;oCACV,IAAI,EAAE,QAAQ;oCACd,QAAQ,EAAE,WAAW;oCACrB,OAAO,EAAE,UAAC,IAAI;wCACZ,OAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;wCAC5C,yBAAyB;oCAC3B,CAAC;iCACF,EAAE;oCACD,IAAI,EAAE,IAAI;oCACV,OAAO,EAAE;wCACP,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;wCAC5B,KAAI,CAAC,cAAc,EAAE;wCACrB,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;oCACtB,CAAC;iCACF;6BACF;yBACF,CAAC;;wBArBI,KAAK,GAAG,SAqBZ;wBAEF,qBAAM,KAAK,CAAC,OAAO,EAAE;;wBAArB,SAAqB,CAAC;;;;;KACvB;IAED,kCAAc,GAAd;QAAA,iBAiCC;QAhCC,IAAI,IAAI,GAAG,uEAAuE,CAAC;QACnF,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,EAAC,kBAAkB,EAAG,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAC,CAAC,CAAC;QAEvF,IAAI,CAAC;YAGL,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,WAAW,CAAC;iBAChC,SAAS,CAAC,cAAI;gBAGb,KAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC;gBAEnC,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,KAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAC1C,mBAAmB;gBACnB,yBAAyB;gBAErB,EAAE,EAAC,IAAI,CAAC,UAAU,CAAC,IAAI,KAAK,CAAC,EAAC;oBAE5B,KAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC9B,CAAC;gBAAA,IAAI,EAAC;oBACJ,KAAI,CAAC,oBAAoB,EAAE,CAAC;oBAC5B,oBAAoB;gBACtB,CAAC;YACL,CAAC,EAAE,eAAK;gBACN,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;gBACvB,KAAK,CAAC,sDAAsD,CAAC,CAAC;YAChE,CAAC,CAAC,CAAC;QAEL,CAAC;QAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACf,KAAK,CAAC,6BAA6B,CAAC;QACtC,CAAC;IAEH,CAAC;IAED,wCAAoB,GAApB;QACE,IAAI,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;YACtC,KAAK,EAAE,0CAA0C;YACjD,QAAQ,EAAE,yDAAyD;YACnE,OAAO,EAAE,CAAC,SAAS,CAAC;SACrB,CAAC,CAAC;QACH,KAAK,CAAC,OAAO,EAAE,CAAC;IAClB,CAAC;IAED,wCAAoB,GAApB;QACE,IAAI,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;YACtC,KAAK,EAAE,iCAAiC;YACxC,QAAQ,EAAE,mDAAmD;YAC7D,OAAO,EAAE,CAAC,SAAS,CAAC;SACrB,CAAC,CAAC;QACH,KAAK,CAAC,OAAO,EAAE,CAAC;IAClB,CAAC;IAED,kCAAc,GAAd;QACE,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAExC,6CAA6C;QAC7C,mDAAmD;QACnD,IAAI,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC;QAClC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAI,IAAI,CAAC,IAAI,CAAC;QAChC,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC;QAC3C,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;QAC7C,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,4BAA4B,GAAC,IAAI,CAAC,UAAU,GAAC,IAAI,CAAC;QACzE,IAAI,CAAC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,UAAU,CAAC;QAEhD,IAAI,CAAC,IAAI,CAAC,UAAU,GAAC,IAAI,CAAC,UAAU,CAAC;QACrC,IAAI,CAAC,IAAI,CAAC,aAAa,GAAC,IAAI,CAAC,aAAa,CAAC;QAC3C,IAAI,CAAC,IAAI,CAAC,IAAI,GAAC,IAAI,CAAC,IAAI,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC,YAAY,GAAC,IAAI,CAAC,YAAY,CAAC;QACzC,IAAI,CAAC,IAAI,CAAC,wBAAwB,GAAC,IAAI,CAAC,wBAAwB,CAAC;QACjE,yHAAyH;QACzH,wBAAwB;IAC1B,CAAC;IAED,iDAA6B,GAA7B,UAA8B,KAAK,EAAC,SAAS,EAAC,OAAO;QAGnD,IAAI,SAAS,CAAC;QACd,IAAI,OAAO,CAAC;QAEX,qCAAqC;QACtC,SAAS,GAAG,KAAK,GAAC,GAAG,GAAC,SAAS,CAAC;QAChC,OAAO,GAAG,KAAK,GAAC,GAAG,GAAC,OAAO,CAAC;QAE5B,IAAI,QAAQ,GAAG,IAAI,IAAI,EAAE,CAAC;QAC1B,cAAc;QACd,IAAI,MAAM,GAAG,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC;QACjC,IAAI,GAAG,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;QAE5B,oDAAoD;QACpD,IAAI,YAAY,GAAG,SAAS,CAAC;QAC7B,IAAI,GAAG,GAAG,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;QAEpD,IAAI,UAAU,GAAG,OAAO,CAAC;QACzB,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;QAEnD,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAEvB,EAAE,CAAC,CAAC,QAAQ,IAAI,GAAG,IAAI,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC;gBACxC,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBACrC,MAAM,CAAC,IAAI,CAAC;YACd,CAAC;YACD,IAAI,CAAC,CAAC;gBACJ,OAAO,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAC;gBACtD,MAAM,CAAC,KAAK,CAAC;YACf,CAAC;QAEH,CAAC;QAAA,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAEjC,EAAE,CAAC,CAAC,QAAQ,IAAI,MAAM,IAAI,QAAQ,IAAI,GAAG,CAAC,CAAC,CAAC;gBAC1C,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBACrC,MAAM,CAAC,IAAI,CAAC;YACd,CAAC;YACD,IAAI,CAAC,CAAC;gBACJ,OAAO,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAC;gBACtD,MAAM,CAAC,KAAK,CAAC;YACf,CAAC;QACH,CAAC;IACH,CAAC;IAGD,2CAAuB,GAAvB;QACE,8BAA8B;QAC9B,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAC,SAAS,CAAC,CAAC;QAChD,wEAAwE;IAC1E,CAAC;IAGD,8BAAU,GAAV;QACE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACtB,CAAC;IAED,gCAAY,GAAZ;QACE,sCAAsC;QACtC,IAAI,CAAC,gBAAgB,EAAE;IAEzB,CAAC;IAGD,iCAAa,GAAb;QACI,wCAAwC;QAD5C,iBAgBC;QAbG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;YACnB,IAAI,EAAE,IAAI,IAAI,EAAE;YAChB,IAAI,EAAE,UAAU;YAChB,YAAY,EAAE,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,gBAAgB;SAC9D,CAAC,CAAC,IAAI,CAAC,cAAI;YACV,KAAK,CAAC,4BAA4B,CAAC;YACnC,KAAI,CAAC,gBAAgB,EAAE;QACzB,CAAC,EACC,aAAG;YACD,KAAK,CAAC,sDAAsD,GAAE,GAAG,CAAC;QACpE,CAAC,CACF,CAAC;IAEN,CAAC;IAED,oCAAgB,GAAhB;QACE,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;IACrB,CAAC;IAED,kCAAc,GAAd;QACE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,yFAAiB,CAAC,CAAC;IACvC,CAAC;IApOU,SAAS;QAJrB,wEAAS,CAAC;YACT,QAAQ,EAAE,YAAY;WACG;SAC1B,CAAC;kBAkBgP;OAjBrO,SAAS,CAsOrB;IAAD,CAAC;AAAA;SAtOY,SAAS,e","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ModalPage } from './modal';\n\n@NgModule({\n  declarations: [\n    ModalPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ModalPage),\n  ],\n})\nexport class ModalPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal/modal.module.ts","import { Component, ÉµConsole } from '@angular/core';\nimport { AlertController,IonicPage, NavController, NavParams, ViewController } from 'ionic-angular';\nimport { InAppBrowser } from '@ionic-native/in-app-browser';\nimport { Platform } from 'ionic-angular';\nimport { HomePage} from  '../home/home';\nimport { ModificarCitaPage } from  '../modificar-cita/modificar-cita';\nimport { DatePicker } from '@ionic-native/date-picker';\nimport {Http, Headers } from '@angular/http';\n\n\n/**\n * Generated class for the ModalPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-modal',\n  templateUrl: 'modal.html',\n})\nexport class ModalPage {\n  data:any = {};\n  fecha_consulta: String;\n  hora_inicio:String;\n  hora_fin:String;\n  detalles_cita:any;\n  tipo_servicio:any;\n  link_token:any;\n  checkRango:any;\n\n  booking_id:any;\n  edad_paciente:any;\n  Sexo:any;\n  padecimiento:any;\n  nombre_completo_paciente:any;\n  \n\n  constructor(private http:Http, public alertController: AlertController, private datePicker: DatePicker,public plt: Platform, private iab: InAppBrowser, public navCtrl: NavController, public navParams: NavParams, private view: ViewController) {\n    this.http = http;  \n    this.data.hora_inicio = '';\n    this.data.hora_fin = '';    \n    this.data.detalles_cita = '';    \n    this.data.tipo_servicio = '';  \n    this.data.link_token_original = ''; \n    this.data.link_token = '';   \n    this.data.fecha_consulta = '';\n    this.data.checkRango = '';\n\n    this.data.booking_id='';\n    this.data.edad_paciente='';;\n    this.data.Sexo='';;\n    this.data.padecimiento='';;\n    this.data.nombre_completo_paciente='';\n\n  }\n\n\n  async eliminarCitaAler() {\n    const alert = await this.alertController.create({\n      title: 'Cancelar cita',\n      message: 'Realmente desea cancelar esta cita de su agenda?',\n      buttons: [\n        {\n          text: 'No',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (blah) => {\n            console.log('No se realiza ninguna accion');\n            //this.retrocederPagina()\n          }\n        }, {\n          text: 'Si',\n          handler: () => {\n            console.log('Confirm Okay');\n            this.eliminarCitaDB()\n            this.view.dismiss();\n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n  eliminarCitaDB(){\n    var link = 'https://topmedic.com.mx/accessDatabase/wp_DB/service/recibirDatos.php';            \n    var credentials = JSON.stringify({booking_key_delete : this.data.link_token_original});\n    \n    try {\n    \n\n    this.http.post(link, credentials)                  \n    .subscribe(data => {\n      \n\n      this.data.response = data[\"_body\"]; \n\n      var resp = JSON.parse(this.data.response);\n      //alert(resp['id'])\n      //alert(resp['response'])\n      \n          if(resp['response'] == \"200\"){\n \n            this.exitoEliminacionCita();              \n          }else{\n            this.errorEliminacionCita();               \n            //this.exitoLogin();\n          }\n      }, error => {\n        console.log(\"Oooops!\");\n        alert(\"No se pudieron enviar los datos\\nIntentelo mas tarde\");          \n      });\n\n    } catch (error) {\n      alert(\"Hay un error en el servidor\")\n    }\n\n  }\n\n  exitoEliminacionCita(){\n    let alert = this.alertController.create({\n      title: '<center><h4>Cita cancelada</h4></center>',\n      subTitle: '<center>La cita ha sido cancelada exitosamente</center>',\n      buttons: ['Aceptar']\n    });\n    alert.present();\n  }\n\n  errorEliminacionCita(){\n    let alert = this.alertController.create({\n      title: '<center><h4>Error</h4></center>',\n      subTitle: '<center>No se ha podido cancelar la cita</center>',\n      buttons: ['Aceptar']\n    });\n    alert.present();\n  }\n\n  ionViewDidLoad(){\n    const data = this.navParams.get('data');    \n\n    //alert(\"En el modal: \"+JSON.stringify(data))\n    //console.log(\"En el modal: \"+JSON.stringify(data))\n    this.data.fecha_consulta = data.fecha_consulta;\n    this.data.hora_inicio = data.hora;\n    this.data.hora_fin  = data.horb;\n    this.data.detalles_cita = data.descripcion;\n    this.data.tipo_servicio = data.tipo_servicio;\n    this.data.link_token = \"https://topmeddr.com:3005/\"+data.link_token+\"/d\";\n    this.data.link_token_original = data.link_token;  \n\n    this.data.booking_id=data.booking_id;\n    this.data.edad_paciente=data.edad_paciente;\n    this.data.Sexo=data.Sexo;\n    this.data.padecimiento=data.padecimiento;\n    this.data.nombre_completo_paciente=data.nombre_completo_paciente;\n    //this.checkRango = this.verificarRangoDeFechasPorCita(this.data.fecha_consulta,this.data.hora_inicio,this.data.hora_fin)\n    //alert(this.checkRango)\n  }\n\n  verificarRangoDeFechasPorCita(fecha,startHour,endHour){\n\n\n    var startTime;\n    var endTime;\n    \n     //Formato de la base de datos de Saul\n    startTime = fecha+\" \"+startHour;\n    endTime = fecha+\" \"+endHour; \n    \n    var fechaHoy = new Date();\n    //Para android\n    let inicio = new Date(startTime);\n    let fin = new Date(endTime);\n    \n    //Para iOS tenemos que modificar el formato de fecha\n    var startTimeMOD = startTime;\n    var stm = new Date(startTimeMOD.replace(/-/g, '/'));\n\n    var endTimeMOD = endTime;\n    var stmf = new Date(endTimeMOD.replace(/-/g, '/'));\n\n    if (this.plt.is('ios')) {\n  \n      if (fechaHoy >= stm && fechaHoy <= stmf) {\n        console.log(\"Esta dentro del rango\");\n        return true;\n      } \n      else {\n        console.log(\"La videoasistencia no puede realizarse\");\n        return false;\n      }\n\n    }else if (this.plt.is('android')) {\n  \n      if (fechaHoy >= inicio && fechaHoy <= fin) {\n        console.log(\"Esta dentro del rango\");\n        return true;\n      } \n      else {\n        console.log(\"La videoasistencia no puede realizarse\");\n        return false;\n      }\n    }\n  }\n\n\n  iniciarVideoconferencia(){    \n    //alert(this.data.link_token )\n    this.iab.create(this.data.link_token,'_system');\n    //var ref = window.open(this.data.link_token, '_blank', 'location=yes');\n  }\n\n\n  closeModal(){\n    this.view.dismiss();\n  }\n\n  eliminarCita(){\n    //alert(\"Entrando a eliminar la cita\")\n    this.eliminarCitaAler()\n\n  }\n\n\n  reasignarCita(){\n      //this.navCtrl.push(ModificarCitaPage); \n\n      this.datePicker.show({\n        date: new Date(),\n        mode: 'datetime',\n        androidTheme: this.datePicker.ANDROID_THEMES.THEME_HOLO_LIGHT\n      }).then(date => {\n        alert(\"Su cita ha sido reasignada\")\n        this.retrocederPagina()\n      },\n        err => {\n          alert('Ha ocurrido un error al tratar de reasignar su cita '+ err)\n        }\n      );\n\n  }\n\n  retrocederPagina(){\n    this.navCtrl.pop();\n  }\n\n  updateDataCita(){\n    this.navCtrl.push(ModificarCitaPage);  \n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal/modal.ts"],"sourceRoot":""}